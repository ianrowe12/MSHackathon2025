g<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Presentation Feedback AI</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #0078d4;
            text-align: center;
            margin-bottom: 30px;
        }
        .input-section {
            margin-bottom: 30px;
        }
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #333;
        }
        input[type="url"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }
        button {
            background-color: #0078d4;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            margin-top: 15px;
        }
        button:hover {
            background-color: #106ebe;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        .loading {
            text-align: center;
            padding: 20px;
            display: none;
        }
        .results {
            margin-top: 30px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 5px;
            display: none;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            display: none;
        }
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #0078d4;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .report-section {
            margin-bottom: 20px;
        }
        .report-section h3 {
            color: #0078d4;
            border-bottom: 2px solid #0078d4;
            padding-bottom: 5px;
        }
        .metric {
            display: inline-block;
            background: #e3f2fd;
            padding: 8px 15px;
            margin: 5px;
            border-radius: 20px;
            font-weight: bold;
        }
        .recommendation {
            background: #fff3cd;
            padding: 10px;
            margin: 10px 0;
            border-left: 4px solid #ffc107;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸŽ¯ AI Presentation Feedback Agent</h1>
        
        <div class="input-section">
            <label for="videoUrl">Video URL (Teams Recording, YouTube, etc.):</label>
            <input type="url" id="videoUrl" placeholder="https://example.com/your-presentation-video.mp4" required>
            <button onclick="analyzePresentation()" id="analyzeBtn">Analyze Presentation</button>
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Analyzing your presentation... This may take a few minutes.</p>
        </div>

        <div class="error" id="error"></div>

        <div class="results" id="results">
            <h2>ðŸ“Š AI Feedback Report</h2>
            <div id="reportContent"></div>
        </div>
    </div>

    <script>
        const FUNCTION_ENDPOINT = 'https://your-function-app.azurewebsites.net/api/analyze_video';
        const OPENAI_ENDPOINT = 'https://your-openai-resource.openai.azure.com/openai/deployments/gpt-4/chat/completions?api-version=2024-02-15-preview';
        const OPENAI_KEY = 'your-openai-api-key'; // In production, use environment variables

        async function analyzePresentation() {
            const videoUrl = document.getElementById('videoUrl').value;
            const analyzeBtn = document.getElementById('analyzeBtn');
            const loading = document.getElementById('loading');
            const error = document.getElementById('error');
            const results = document.getElementById('results');

            if (!videoUrl) {
                showError('Please enter a video URL');
                return;
            }

            // Show loading
            analyzeBtn.disabled = true;
            loading.style.display = 'block';
            error.style.display = 'none';
            results.style.display = 'none';

            try {
                // Step 1: Call your Azure Function to analyze video
                console.log('Calling video analysis function...');
                const analysisResponse = await fetch(FUNCTION_ENDPOINT, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ video_url: videoUrl })
                });

                if (!analysisResponse.ok) {
                    throw new Error(`Analysis failed: ${analysisResponse.statusText}`);
                }

                const insights = await analysisResponse.json();
                console.log('Video analysis complete:', insights);

                // Step 2: Generate AI report using insights
                console.log('Generating AI report...');
                const report = await generateAIReport(insights);

                // Step 3: Display results
                displayResults(insights, report);

            } catch (err) {
                console.error('Error:', err);
                showError(`Error: ${err.message}`);
            } finally {
                analyzeBtn.disabled = false;
                loading.style.display = 'none';
            }
        }

        async function generateAIReport(insights) {
            const prompt = `
You are an expert presentation coach. Analyze this video presentation data and provide detailed feedback.

VIDEO ANALYSIS DATA:
${JSON.stringify(insights, null, 2)}

Please provide:
1. EXECUTIVE SUMMARY (2-3 sentences)
2. STRENGTHS (what they did well)
3. AREAS FOR IMPROVEMENT (specific actionable advice)
4. VISUAL PRESENCE SCORE (out of 10)
5. RECOMMENDED NEXT STEPS

Make it encouraging but honest. Focus on actionable advice.
            `;

            const response = await fetch(OPENAI_ENDPOINT, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'api-key': OPENAI_KEY
                },
                body: JSON.stringify({
                    messages: [
                        {
                            role: 'system',
                            content: 'You are a professional presentation coach providing constructive feedback.'
                        },
                        {
                            role: 'user',
                            content: prompt
                        }
                    ],
                    max_tokens: 1000,
                    temperature: 0.7
                })
            });

            if (!response.ok) {
                throw new Error(`AI report generation failed: ${response.statusText}`);
            }

            const result = await response.json();
            return result.choices[0].message.content;
        }

        function displayResults(insights, aiReport) {
            const reportContent = document.getElementById('reportContent');
            
            reportContent.innerHTML = `
                <div class="report-section">
                    <h3>ðŸ¤– AI-Generated Feedback</h3>
                    <div style="white-space: pre-wrap; line-height: 1.6;">${aiReport}</div>
                </div>

                <div class="report-section">
                    <h3>ðŸ“ˆ Key Metrics</h3>
                    <div class="metric">Faces Detected: ${insights.facial_analysis?.faces_detected || 0}</div>
                    <div class="metric">Engagement Score: ${insights.presentation_quality?.visual_engagement || 'N/A'}</div>
                    <div class="metric">Overall Tone: ${insights.visual_sentiment?.overall_tone || 'N/A'}</div>
                </div>

                <div class="report-section">
                    <h3>ðŸ’¡ Recommendations</h3>
                    ${insights.recommendations?.map(rec => `
                        <div class="recommendation">
                            <strong>${rec.category}:</strong> ${rec.suggestion}
                        </div>
                    `).join('') || 'No specific recommendations available.'}
                </div>
            `;

            document.getElementById('results').style.display = 'block';
        }

        function showError(message) {
            const error = document.getElementById('error');
            error.textContent = message;
            error.style.display = 'block';
        }
    </script>
</body>
</html>
